"use strict";let s=require("fs"),e=require("request");const r={ciphers:"ALL",secureProtocol:"TLSv1_method"};exports.post=function(s,t,o){e.post({url:s,json:!0,form:t,agentOptions:r},(s,e,r)=>{s||200!=e.statusCode?o({err_code:e.statusCode,err_msg:s},null):0===r.status||"success"===r.error_code?(resolve(r),o(null,r)):o({err_code:r.status?r.status:r.err_code,err_msg:r.status?r.msg:r.error_msg},null)})},exports.postAsync=function(s,t){return new Promise((o,u)=>{e.post({url:s,json:!0,form:t,agentOptions:r},(s,e,r)=>{try{s||200!=e.statusCode?u({err_code:e.statusCode,err_msg:s}):0===r.status||"success"===r.error_code?o(r):u({err_code:r.status?r.status:r.err_code,err_msg:r.status?r.msg:r.error_msg})}catch(s){}})})},exports.get=function(s,t,o){e.get({url:s,json:!0,form:t,agentOptions:r},(s,e,r)=>{s||200!=e.statusCode?o({err_code:e.statusCode,err_msg:s},null):0===r.status||"success"===r.error_code?(resolve(r),o(null,r)):o({err_code:r.status?r.status:r.err_code,err_msg:r.status?r.msg:r.error_msg},null)})},exports.download=function(t,o,u){var n=0,a=0,c=0,l=e({method:"GET",uri:t,agentOptions:r}),d=s.createWriteStream(o);l.pipe(d),l.on("response",s=>{if(200!==s.statusCode)return u(new Error(s.statusMessage),null),void 0;n=parseInt(s.headers["content-length"],10)}),l.on("data",s=>{var e=(a+=s.length)/n*100|0;c!==e&&(c=e,u(null,{status:"downloading",progress:e}))}),l.on("complete",()=>{u(null,{status:"complete",progress:c})}),l.on("error",s=>{u(s,null)})};