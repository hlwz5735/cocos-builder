"use strict";let e=require("./collider-gizmo"),t=require("../tools"),r={None:0,Side:1,Center:2};module.exports=class extends e{onCreateMoveCallbacks(){let e,t,o,s;return{start:(r,i,l,c)=>{e=this.target.offset,t=this.target.radius,o=r,s=i},update:(t,i,l,c)=>{if(c===r.Center){let r=this.screenToNodeLocalDelta(cc.v2(t,i),this.node);r.addSelf(e),this.target.offset=r,this.adjustValue(this.target,"offset")}else{let r=this.screenToNodeLocalPos(cc.v2(o+t,s+i),this.node).subSelf(e).mag();this.target.radius=r,this.adjustValue(this.target,"radius")}}}}onCreateRoot(){let e,o,s,i,l,c,a,n=this._root,d=(e,o)=>t.circleTool(e,5,{color:"#7fc97a"},null,this.createMoveCallbacks(r.Side)).style("cursor",o);n.dragArea=a=n.circle("0,0,0,0,0,0").fill({color:"rgba(0,128,255,0.2)"}).stroke("none").style("pointer-events","fill"),this.registerMoveSvg(a,r.Center),(e=n.circle=t.circleTool(n,0,null,{color:"#7fc97a"},this.createMoveCallbacks(r.Side))).style("pointer-events","none"),(o=n.sidePointGroup=n.group()).hide(),s=d(o,"col-resize"),i=d(o,"row-resize"),l=d(o,"col-resize"),c=d(o,"row-resize"),n.plot=((t,r)=>{e.radius(r).center(t.x,t.y),a.radius(r).center(t.x,t.y),this._targetEditing&&(s.center(t.x-r,t.y),i.center(t.x,t.y+r),l.center(t.x+r,t.y),c.center(t.x,t.y-r))})}onUpdate(){let e=this.node,t=this.target.radius,r=this.worldToPixel(e.convertToWorldSpaceAR(this.target.offset)),o=this.worldToPixel(e.convertToWorldSpaceAR(cc.v2(0,0))),s=this.worldToPixel(e.convertToWorldSpaceAR(cc.v2(t,0))),i=o.sub(s).mag();this._root.plot(r,i)}enterEditing(){let e=this._root;e.circle.style("pointer-events","stroke"),e.dragArea.style("cursor","move"),e.sidePointGroup.show()}leaveEditing(){let e=this._root;e.circle.style("pointer-events","none"),e.dragArea.style("cursor",null),e.sidePointGroup.hide()}};