!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var s=e();for(var o in s)("object"==typeof exports?exports:t)[o]=s[o]}}(window,(function(){return function(t){var e={};function s(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=t,s.c=e,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(o,i,function(e){return t[e]}.bind(null,i));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=116)}({108:function(t,e,s){const o=s(25);t.exports=class{constructor(t){this._items=new Map,this._projectClass=t}add(t){let e=new this._projectClass(t);if(!e.validate())throw new Error(`This is path "${t}" is not project`);if(this._items.has(e.path))throw new Error(`This path "${t}" already imported`);return this._items.set(e.path,e),e}remove(t){o(this._items.has(t)),this._items.delete(t)}get(t){return o(this._items.has(t)),this._items.get(t)}first(){return this._items.values().next().value}clear(){this._items.clear()}count(){return this._items.size}}},109:function(t,e,s){const o="win32"===s(11).platform()?"\\":"/",i=s(6),n=(s(23),s(53));t.exports=class extends n{constructor(t){super(t,"cocos"),this._live=!1,this._plugins=[]}validate(){let t=this._path+o+".cocos-project.json";try{let e=JSON.parse(i.readFileSync(t));this._engine=e.engine_version}catch(t){return console.log("CocosProject.validate() failed: "+t.toString()),!1}return!0}get live(){return this._live}get plugins(){return this._plugins}updatePluginsFromJSON(t){let e=[];for(var s in t){let o=t[s],i={name:o.name,version:o.version.join(".")};e.push(i)}this._plugins=e.sort((t,e)=>t.name<e.name?-1:t.name>e.name?1:0)}}},11:function(t,e){t.exports=require("os")},110:function(t,e,s){const o="win32"===s(11).platform()?"\\":"/",i=s(6),n=s(2),l=(s(23),s(18)),a=s(53);t.exports=class extends a{constructor(t){super(t,"creator"),this._live=!1,this._plugins=[],this._template=null}validate(){let t=this._path+o+".cocos-project.json";l.isFile(t)?(this._template=n.basename(this._path),console.log("creator template:",this._template)):t=this._path+o+"project.json";try{let e=JSON.parse(i.readFileSync(t));this._engine=e.engine}catch(t){return console.log("CreatorProject.validate() failed: "+t.toString()),!1}return this._xcodeProjectEnable=!0,this._androidProjectEnable=!0,this.getXcodeProjects(),this.getAndroidProjects(),!0}get live(){return this._live}get plugins(){return this._plugins}get template(){return this._template}updatePluginsFromJSON(t){let e=[];for(var s in t){let o=t[s],i={name:o.name,version:o.version.join(".")};e.push(i)}this._plugins=e.sort((t,e)=>t.name<e.name?-1:t.name>e.name?1:0)}findFile(t){i.readFileSync(t).forEach(t=>{i.i})}searchFile(t,e){const s=[],o=function(t){let l=[];try{l=i.readdirSync(t)}catch(t){l=[]}l.forEach(l=>{let a=0;const r=n.join(t,l);if(e&&(a=e(r)),1==a)s.push(r);else if(2==a);else{i.statSync(r).isDirectory()&&o(r)}})};return o(t),s}getXcodeProjects(){const t=this,e=n.join(this._path,"frameworks","runtime-src","proj.ios_mac"),s=this.searchFile(e,(function(t){return t.endsWith(".xcodeproj")?1:t.endsWith(".framework")||t.endsWith(".xcassets")?2:0}));let o=!1;const i=[];return s.forEach(s=>{let l=n.relative(n.dirname(e),s);i.push(l),l==t._xcodeproj&&(o=!0)}),i.sort((function(t,e){return t.includes("backup")?1:e.includes("backup")?-1:0})),o||(this._xcodeproj=i[0]),i}setSelectXcodeProject(t){this._xcodeproj=t}getSelectXcodeProject(){return this._xcodeproj}setXcodeProjectEnable(t){this._xcodeProjectEnable=t}isXcodeProjectEnable(){return this._xcodeProjectEnable}getAndroidProjects(){const t=this,e=n.join(this._path,"frameworks","runtime-src"),s=this.searchFile(e,(function(t){return t.includes("proj.android")?1:2}));let o=!1;const i=[];return s.forEach(s=>{let l=n.relative(e,s);i.push(l),l==t._androidproj&&(o=!0)}),i.sort((function(t,e){return t.includes("backup")?1:e.includes("backup")?-1:0})),o||(this._androidproj=i[0]),i}setSelectAndroidProject(t){this._androidproj=t}getSelectAndroidProject(){return this._androidproj}setAndroidProjectEnable(t){this._androidProjectEnable=t}isAndroidProjectEnable(){return this._androidProjectEnable}}},111:function(t,e,s){const o=s(7).remote.dialog,i=s(7).remote.BrowserWindow,n=s(30),l=s(37),a=s(112),r=(s(54),s(55)),c=s(28),d=["ESSENTIALS","ANALYTICS","IAP OPTIMIZATION","APP STORES","AD UNITS","SOCIAL","ATTRIBUTION","PUSH NOTIFICATION","MORE"];class h{constructor(){this.plugins={},this._lastLoad=0,this.sdkbox_path=n.getSdkboxBinPath()}load(t){this._callback=t,c.getInstance().fetchManifest((t,e)=>{this._onLoadCallback(e,t,null)})}_onLoadCallback(t,e,s){try{if(t)throw new Error(t.toString());{let t=e.packages,s=[];Object.keys(t).forEach(e=>{if("SDKBOX"==e)return;let o=t[e];if(o.is_library)return;let i={name:e,display_name:o.display_name,category:o.category,description:o.description};Object.keys(o.versions).forEach(t=>{i.version=t}),s.push(i)}),this.plugins={},s.forEach(t=>{let e=this.plugins[t.category];e||(e=[]),e.push(t),this.plugins[t.category]=e}),this._lastLoad=Date.now(),"function"==typeof this._callback&&(this._callback(!0),this._callback=null)}}catch(t){o.showErrorBox("Download Plugins List Failed",t.toString()),"function"==typeof this._callback&&(this._callback(!1),this._callback=null)}}}t.exports=class{constructor(){this._dialog=getImportCocosPluginsDialog(),this._dialog.on("dialogclose",()=>{this._onClose()}),this._consoleDialog=l.getInstance(),this._queryInstallTapcoreDialog=new a,this._loaderHtml=this._dialog.find(".loader"),this._contentsHtml=this._dialog.find(".contents"),this._treeHtml=this._contentsHtml.find("> div"),this._treeComponentTpl=this._treeHtml.find(".tree-component"),this._list=new h,this.sdkbox_path=this._list.sdkbox_path}load(){n.isInstalled()&&this._list.load()}open(t,e){this._project=t,this._callback=e,this._loaderHtml.show(),this._contentsHtml.hide(),this._treeHtml.empty(),this._dialog.dialog("open"),this._list.load(e=>{e?this._updateTable(t):this._dialog.dialog("close")})}_onClose(){this._project=null,this._callback=null}_updateTable(t){this._loaderHtml.hide(),this._contentsHtml.show();let e=new Map;t.plugins.forEach(t=>{e.set(t.name,t)});let s=this._list.plugins;for(let t of d)s[t]&&this._treeHtml.append(this.genTreeComponent(t,s[t]));this.registerEvent()}genTreeComponent(t,e){let s=this._treeComponentTpl.clone();s.removeClass("hidden"),s.find(".tree-header-content").html(t);let o=1;return e.forEach(t=>{let e=t.name.toString();"gpg"==e&&(e="googleplay");const i=`\n            <div class="tree-item ${"tree-item-bg-"+o}">\n                <span class="tree-item-content">\n                    <a href="http://docs.sdkbox.com/en/plugins/${e}">${t.display_name}</a>\n                    <span class="tree-item-content-tip">${t.description}</span>\n                </span>\n                <button class="tree-item-action">Import</button>\n            </div>\n            `;s.find(".tree-content").append($(i)),o=(o+=1)>2?1:o}),s}registerEvent(){const t=this;this._treeHtml.find(".tree-header").on("click",(function(){const t=$(this).parent(),e=t.find(".tree-content"),s=e.is(":visible")?"-90":"0";e.toggle(100),t.find(".tree-header-icon").css({transform:"rotate("+s+"deg)"})})),this._treeHtml.find(".tree-item-action").on("click",(function(){const e=$(this).parent().find(".tree-item-content>a").get(0).firstChild.nodeValue.trim();t._onImportClick(c.getInstance().getPluginName(e),e)}))}_onImportClick(t,e){let s=[];if(s.push(t),0!==s.length)if("tapcore"==t)this._queryInstallTapcoreDialog.open(t=>{let e=this._callback,o=this._project;this._dialog.dialog("close"),this._callback=e,this._project=o,this._selected=s,this._importPlugin(t)});else{let t={type:"question",buttons:["Import","Cancel"],defaultId:0,title:"Confirm import selected plugins",message:"Confirm import selected plugins:",detail:e,cancelId:1};o.showMessageBox(i.getFocusedWindow(),t,t=>{if(0===t){let t=this._callback,e=this._project;this._dialog.dialog("close"),this._callback=t,this._project=e,this._selected=s,this._importPlugin()}})}else o.showErrorBox("Warning","Please select least one plugin")}_importFinish(){this._consoleDialog.enableClose();let t=this._callback;this._project=null,this._callback=null,t()}_importPlugin(t){c.getInstance().getInstalledPlugins(this._project.path,(e,i)=>{if(i)o.showErrorBox("Query SDKBOX Info Failed",i);else{new r({creator_project_root:s(18).queryParams().project,plugins:this._selected,project:this._project.path,cmd:"import",installedPlugins:Object.keys(e),tapcore_token:t}).show()}})}}},112:function(t,e){t.exports=class{constructor(){this._dialog=getQueryInstallTapCoreDialog(),this._dialog.on("dialogclose",()=>{this._onClose()}),this._dialog.wrapper=this}open(t){this._callback=t,this._dialog.dialog("open"),this._token=this._dialog.find(".tapcore-token")}import(){let t=this._token.val();void 0!==t&&0!=t.length?(this._callback&&this._callback(t),this._dialog.dialog("close")):alert("you must fill tapcore token before install tapcore")}_onClose(){this._callback=null}}},113:function(t,e,s){const o=s(11),i=s(6),n=s(2),l=s(51);let a;t.exports=class t{static getInstance(){return a||(a=new t),a}constructor(){let t=o.homedir();this._path=n.join(t,".sdkbox","conf","gui.json")}load(){try{let t=i.readFileSync(this._path);return JSON.parse(t)}catch(t){return console.log(t.toString()),null}}save(t){let e=JSON.stringify(t);const s=n.dirname(this._path);let o=null;try{o=i.statSync(s)}catch(t){o=null}o&&!o.isDirectory()||l.sync(n.dirname(this._path)),i.writeFileSync(this._path,e)}}},114:function(t,e){t.exports=require("url")},116:function(t,e,s){"use strict";s.r(e);s(28);var o=s(59),i=s.n(o),n=s(60),l=s.n(n);let a,r="1.3.9",c=!1;const{shell:d,ipcRenderer:h}=s(7),u=s(114),p=function(t){let e=u.parse(t).protocol;return("http:"===e||"https:"===e)&&(d.openExternal(t),!0)};$(document).ready(()=>{document.title=`${document.title} (${r}${c?" Beta":""})`;const t=document.querySelectorAll('link[rel="import"]');let e=$("#contents");$(t).each((t,s)=>{let o=s.import.querySelector(".tab-template"),i=document.importNode(o.content,!0);e.append(i)}),$("webview").each((t,e)=>{e.addEventListener("did-finish-load",e=>{console.log(t,e)}),e.addEventListener("will-navigate",t=>{p(t.url)&&e.stop()})}),i.a.select_tab("cocos"),$("button").on("click",t=>{t.target.blur()}),a=new l.a,$("#tabbar").hide(),$("#contents").css("top","77px")}),$(document).on("click",'a[href^="http"]',(function(t){p(t.target.href)&&t.preventDefault()}))},18:function(t,e,s){const o=s(6),i=s(11),n=s(51),l=s(2);t.exports=class t{static arrayUnique(t){for(var e=0;e<t.length;++e)for(var s=e+1;s<t.length;++s)t[e]===t[s]&&t.splice(s--,1);return t}static queryParams(){var t={};if("undefined"==typeof window)return"";for(var e=window.location.search.substring(1).split("&"),s=0;s<e.length;s++){var o=e[s].split("=");if(void 0===t[o[0]])t[o[0]]=decodeURIComponent(o[1]);else if("string"==typeof t[o[0]]){var i=[t[o[0]],decodeURIComponent(o[1])];t[o[0]]=i}else t[o[0]].push(decodeURIComponent(o[1]))}return t}static isFile(t){let e=null;try{e=o.statSync(t)}catch(t){e=null}return!!e&&e.isFile()}static isDir(t){let e=null;try{e=o.statSync(t)}catch(t){e=null}return!!e&&e.isDirectory()}static exist(t){let e=null;try{e=o.statSync(t)}catch(t){e=null}return!!e}static makedir(t){let e=null;try{e=o.statSync(t)}catch(t){e=null}e&&!e.isDirectory()||n.sync(t)}static copy(e,s){t.makedir(s);const i=l.join(s,l.basename(e));o.createReadStream(e).pipe(o.createWriteStream(i))}static getSdkboxBinPath(){const t=l.join(i.homedir(),".sdkbox","bin","sdkbox");return"win32"==i.platform()?t+".bat":t}static isSdkboxInstalled(){const t=l.join(i.homedir(),".sdkbox","bin","sdkbox");let e=null;try{e=o.statSync(t)}catch(t){e=null}return!!e&&e.isFile()}}},2:function(t,e){t.exports=require("path")},23:function(t,e){t.exports=require("child_process")},25:function(t,e){t.exports=require("assert")},28:function(t,s,o){const i=o(2),n=o(29),l=o(30),a=o(18);let r;const c={adcolony:"AD UNITS",admob:"AD UNITS",agecheq:"MORE",amazon:"APP STORES",appnext:"AD UNITS",appodeal:"AD UNITS",apteligent:"ANALYTICS",bee7:"AD UNITS",chartboost:"AD UNITS",facebook:"SOCIAL",flurryanalytics:"ANALYTICS",fyber:"AD UNITS",googleanalytics:"ANALYTICS",gpg:"ESSENTIALS",iap:"ESSENTIALS",inmobi:"AD UNITS",kochava:"ATTRIBUTION",leadbolt:"AD UNITS",onesignal:"PUSH NOTIFICATION",playphone:"APP STORES",review:"ESSENTIALS",sdkboxads:"ESSENTIALS",sdkboxplay:"ESSENTIALS",share:"ESSENTIALS",scientificrevenue:"IAP OPTIMIZATION",tune:"ATTRIBUTION",valuepotion:"IAP OPTIMIZATION",vungle:"AD UNITS",youtube:"MORE"},d={adcolony:"Instant-play™ HD the best user experience, hands down.",agecheq:"Easy compliance with the US and Euro Child Privacy Laws",appodeal:"Maximize your app revenue efficiently with programmatic ad mediation for publishers.",bee7:"Our Native rewarded re-engagement system encourages valuable players to stay in your game.",chartboost:"The largest mobile games-only platform to increase revenue and discover new players.",facebook:"The world's largest social media network.",flurryanalytics:"Adopt the industry standard, for free.",googleanalytics:"Turn insights into action.",iap:"Implement Cross-Platform IAP easily. Support Apple AppStore, Google Play, Amazon AppStore, and Playphone store.",inmobi:"The Discovery Platform for a Mobile-First World.",kochava:"Driving Effective Mobile Ad Spend",leadbolt:"The high-performance mobile advertising platform for user acquisition and app monetization.",review:"More downloads of your app with App store ratings and reviews.",tune:"Making mobile marketing better, for everyone.",valuepotion:"Monetize your full user base and get your values up!",vungle:"Infrastructure for app monetization through video ads.",youtube:"Single API to play YouTube videos on both iOS and Android.",fyber:"Designed with you in mind, Fyber empowers developers to execute smart ad monetization strategies.",playphone:"Your new, must-have game monetization channel in the world’s fastest growing gaming markets.",scientificrevenue:"Pricing without Compromise.",admob:"Monetize your apps intelligently",amazon:"The exclusive appstore on Kindle tablets, but available for other devices, too.",appnext:"Grow Your Mobile Business by Promoting Apps.",sdkboxplay:"Cross platform support for both Apple Game Center and Google Play Services, including Login, Achievement and Leaderboard.",gpg:"The most secure and reliable game services for your mobile games now available on both Android and iOS!",onesignal:"OneSignal is a free high volume Push Notification service.",apteligent:"Build Better Apps Faster: crash reporting and realtime performance data.",sdkboxads:"An easy-to-use package that includes all SDKBOX supported Ad Units.",share:"Grow audience network by publishing social messages to Facebook and Twitter."};t.exports=class t{static getInstance(){return r||(r=new t),r}constructor(){this.manifestJson=null,this.changeServer("production"),this.sdkbox_path=l.getSdkboxBinPath(),this.projects={},this.observerTagPrefix="ObserverTag-",this.observerTagCounter=1,this.projs=null}changeServer(t){let e=null;(e="staging"==t?"http://staging.sdkbox.com/installer/v1/":"http://download.sdkbox.com/installer/v1/")!=this.serverUrl&&(this.serverUrl=e,this.manifestJson=null)}isStaging(){return-1!=this.serverUrl.indexOf("staging")}getDownloadPath(t,e){if(null==this.manifestJson)return null;t=t.toLowerCase();try{const s=this.manifestJson.packages[t].versions;let o=null;for(let t in s){o=s[t][e],o=$.extend({},o);break}return null==o?null:(o.bundle=this.serverUrl+o.bundle,o)}catch(t){return null}}getDisplayName(t){if(null==this.manifestJson)return null;let e=t;try{e=this.manifestJson.packages[t].display_name}catch(s){e=t}return e}getPluginName(t){if(null==this.manifestJson)return null;const e=Object.keys(this.manifestJson.packages);for(let s in e){const o=e[s];if(this.manifestJson.packages[o].display_name==t)return o}}getInstallerPath(){if(null==this.manifestJson)return null;try{const t=this.manifestJson.packages.SDKBOX.versions;let e=null;for(let s in t){e=t[s],e=$.extend({},e);break}return null==e?null:(e.bundle=this.serverUrl+e.bundle,e)}catch(t){return null}}fetchManifest(t){this.fetchJson(this.serverUrl+"manifest.json",(e,s)=>{this.addCategoryInfo(e),this.addDescptionInfo(e),t(e,s)})}fetchPackage(t,e,s){this.fetchManifest((o,i)=>{if(null==o)return void s(null,"fetch manifest failed");const n=this.getDownloadPath(t,e);this.fetchData(n,s)})}fetchJson(t,e){if(null!=this.manifestJson)return void e(this.manifestJson,null);const s=this;this.fetchUrl(t,t=>{"string"==typeof t?e(null,t):t instanceof Response?t.ok?t.json().then((function(t){s.manifestJson=t,e(s.manifestJson,null)})):e(null,`failed, status: ${t.status}`):e(null,"unknow res type")})}fetchData(t,e){null!=t?this.fetchUrl(t,t=>{"string"==typeof t?e(null,t):t instanceof Response?t.ok?e(t,null):e(null,`failed, status: ${t.status}`):e(null,"unknow res type")}):e(null,"failed, url is null")}fetchUrl(t,e){fetch(t).then((function(t){e(t)}),(function(t){e(t.message)}))}getInstalledPlugins(t,e,s=!1){!s&&t in this.projects&&this.projects[t]?e&&e(this.projects[t],null):this.queryInstalledPlugins(t,e)}queryInstalledPlugins(t,s){if(!a.isFile(i.join(t,".sdkbox_packages.json")))return console.log("project not include sdkbox packages"),this.projects[t]=this.projects[t]||{},void(s&&s(this.projects[t]));let o="sdkbox info "+t,l=n.getInstance();if(l.query(o))return;let r=[this.sdkbox_path,"--alwaysupdate","--local","--jsonapi","info"];const c=this.projs.get(t);let d=c.getSelectXcodeProject();c.isXcodeProjectEnable()&&d&&(r.push("--projectpath"),r.push(d)),d=c.getSelectAndroidProject(),c.isAndroidProjectEnable()&&d&&(r.push("--projectpath"),r.push(d));let h={tag:o,cwd:t};l.exec(r,h,(o,i,n)=>{let l=null,a=null;try{o?a=e.toString():(null!=i&&0!=i.length||(i="{}"),l=JSON.parse(i))}catch(t){a=t.toString()}a||(this.projects[t]=l),s&&s(l,a);for(let e in this._installedPluginsObserver)this._installedPluginsObserver[e]&&this._installedPluginsObserver[e](l,t)})}observeInstalledPlugin(t){this._installedPluginsObserver||(this._installedPluginsObserver={}),this._installedPluginsObserver[`${this.observerTagPrefix}${this.observerTagCounter}`]=t,this.observerTagCounter++}getDependency(t){if(Array.isArray(t)){let e=[];for(let s in t){const o=t[s],i=this.getDependency(o);i&&(e=e.concat(i))}return e}{if(!this.manifestJson)return;const e=t;let s=null;try{s=this.manifestJson.packages[e].dependence}catch(t){console.log(t),s=null}return s&&0==s.length&&(s=null),s}}addCategoryInfo(t){if(t)for(let e in t.packages){let s=t.packages[e];if(s.category)continue;const o=c[e]?c[e]:"MORE";s.category=o}}addDescptionInfo(t){if(t)for(let e in t.packages){let s=t.packages[e];if(s.description)continue;const o=d[e]?d[e]:"SDKBox Plugin:"+e;s.description=o}}getPluginPath(t){if(null==this.manifestJson)return null;t=t.toLowerCase();try{const e=this.manifestJson.packages[t].versions;let s=null;for(let t in e){s=e[t].v3,s=$.extend({},s);break}if(null==s)return null;{let t=s.bundle.slice(0,-7);return l.getSdkboxPluginsPath(t)}}catch(t){return null}}getXcodeProject(t){if(null==this.projs)return null;let e=null;try{e=this.projs.get(t).getSelectXcodeProject()}catch(t){console.log(t)}return e}getProjectByPath(t){if(null==this.projs)return null;let e=null;try{e=this.projs.get(t)}catch(t){console.log(t)}return e}}},29:function(t,e,s){const o=s(2),i=s(50),n=s(23),l=s(18).queryParams();let a;t.exports=class t{static getInstance(){return a||((a=new t).builtinCocosRoot=l.builtinCocosRoot),a}constructor(){this._process=new Map}exec(t,e,s){this._nextId++;let l=t.shift(),a=e.tag;if(delete e.tag,this.builtinCocosRoot){const t=o.join(this.builtinCocosRoot,"tools","cocos2d-console","bin");e.env={PATH:i.env.PATH,COCOS_CONSOLE_ROOT:t}}let r=n.spawn(l,t,e);console.log(`[CLI] spawn (${r.pid}): ${l} ${t.join(" ")}`);let c=this._process;c.set(a,r);let d=[],h=[];r.stdout.on("data",t=>{d.push(t),"object"==typeof s&&s.stdout(t)}),r.stderr.on("data",t=>{h.push(t),"object"==typeof s&&s.stderr(t)}),r.on("error",t=>{c.has(a)&&c.delete(a),"object"==typeof s?s.error(t,d.join(""),h.join("")):"function"==typeof s&&s(t,d.join(""),h.join(""))}),r.on("exit",(t,e)=>{e=e||"",console.log(`[CLI] exit (${r.pid}) ${t} ${e}`),c.has(a)&&c.delete(a),"object"==typeof s?s.exit(d.join(""),h.join("")):"function"==typeof s&&s(null,d.join(""),h.join(""))})}kill(t){if(this._process.has(t)){let e=this._process[t];e&&e.kill(),this._process.delete(t)}}query(t){return this._process.has(t)}}},30:function(t,e,s){const o=s(11),i=s(2),n=s(6),l=(s(50),s(7).remote.dialog),a=s(29),r=s(37);function c(t){const e=i.join(o.homedir(),".sdkbox","bin","sdkbox");let s=null;try{s=n.statSync(e)}catch(t){s=null}return!!s&&s.isFile()}e.installIf=function(){c()||function(){let t=a.getInstance(),e="install sdkbox";if(t.query(e))return;const s=r.getInstance();s.open(),s.disableClose(),s.clear(),s.log("Prepare to install SDKBox Installer, please wait...");t.exec(["python","-c","import urllib; s = urllib.urlopen('https://raw.githubusercontent.com/sdkbox-doc/en/master/install/install.py').read(); exec s"],{tag:e},{stdout:t=>{s.log(t.toString())},stderr:t=>{s.log(t.toString())},exit:(t,e)=>{s.enableClose()},error:(t,e,o)=>{s.log(t.toString());s.log("\n\nInstall SDKBox installer failed.\nPlease tell us at (http://www.sdkbox.com/answers/)")}})}()},e.getSdkboxBinPath=function(){const t=i.join(o.homedir(),".sdkbox","bin","sdkbox");if(t)return"win32"==o.platform()?t+".bat":t;l.showErrorBox("SDKBox installer not found","can't found installer at ~/.sdkbox/bin")},e.getSdkboxPluginsPath=function(t){const e=i.join(o.homedir(),".sdkbox","plugins");return t?i.join(e,t):e},e.isInstalled=c},37:function(t,e,s){let o;s(52),t.exports=class t{static getInstance(){return o||(o=new t),o}constructor(){this._enableClose=!1,this._dialog=getConsoleOutputDialog(),this._dialog.on("dialogbeforeclose",(t,e)=>this._enableClose),this._output=this._dialog.find(".output"),this._buttonsHtml=this._dialog.parent().find(".ui-dialog-buttonset button"),this.disableClose()}open(){this._dialog.dialog("open"),this._dialog.dialog("moveToTop")}close(){this._dialog.dialog("close")}enableClose(){this._enableClose=!0,this._buttonsHtml.button("enable")}disableClose(){this._enableClose=!1,this._buttonsHtml.button("disable")}log(t){let e=$("<div>").html(t.autoLink());this._output.append(e),this._output.append("\n")}clear(){this._output.empty()}}},50:function(t,e){t.exports=require("process")},51:function(t,e,s){var o=s(2),i=s(6),n=parseInt("0777",8);function l(t,e,s,a){"function"==typeof e?(s=e,e={}):e&&"object"==typeof e||(e={mode:e});var r=e.mode,c=e.fs||i;void 0===r&&(r=n&~process.umask()),a||(a=null);var d=s||function(){};t=o.resolve(t),c.mkdir(t,r,(function(s){if(!s)return d(null,a=a||t);switch(s.code){case"ENOENT":l(o.dirname(t),e,(function(s,o){s?d(s,o):l(t,e,d,o)}));break;default:c.stat(t,(function(t,e){t||!e.isDirectory()?d(s,a):d(null,a)}))}}))}t.exports=l.mkdirp=l.mkdirP=l,l.sync=function t(e,s,l){s&&"object"==typeof s||(s={mode:s});var a=s.mode,r=s.fs||i;void 0===a&&(a=n&~process.umask()),l||(l=null),e=o.resolve(e);try{r.mkdirSync(e,a),l=l||e}catch(i){switch(i.code){case"ENOENT":l=t(o.dirname(e),s,l),t(e,s,l);break;default:var c;try{c=r.statSync(e)}catch(t){throw i}if(!c.isDirectory())throw i}}return l}},52:function(t,e){(function(){var t=[].slice;String.prototype.autoLink=function(){var e,s,o,i,n,l;return n=/(^|[\s\n]|<[A-Za-z]*\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,0<(i=1<=arguments.length?t.call(arguments,0):[]).length?(o=i[0],s=function(){var t;for(e in t=[],o)l=o[e],"callback"!==e&&t.push(" "+e+"='"+l+"'");return t}().join(""),this.replace(n,(function(t,e,i){return""+e+(("function"==typeof o.callback?o.callback(i):void 0)||"<a href='"+i+"'"+s+">"+i+"</a>")}))):this.replace(n,"$1<a href='$2'>$2</a>")}}).call(this)},53:function(t,e,s){const o="win32"===s(11).platform()?"\\":"/";t.exports=class{constructor(t,e){let s=null;if("string"==typeof t){let e=(t=t.toString()).charAt(t.length-1);"/"!==e&&"\\"!==e||(t=t.substring(0,t.length-2)),s=t.substring(t.lastIndexOf(o)+1)}else s=t.projectName,t=t.projectPath;this._name=s,this._path=t,this._engine=e,this._icon=""}validate(){return!1}get name(){return this._name}get path(){return this._path}get engine(){return this._engine}get icon(){return this._icon}}},54:function(t,e,s){const{ipcRenderer:o}=s(7);let i;t.exports=class t{static getInstance(){return i||(i=new t),i}constructor(){o.on("download-status",(t,e)=>{"interrupted"===e.state?(this._downloadFailList.push(this._downloadingPlugin),this.download()):"progressing"===e.state&&this.setProgress(e.downloadRatio)}),o.on("download-finish",(t,e)=>{delete this._dlUrl,"completed"===e.state?this._downloadSuccessList.push(this._downloadingPlugin):(this._downloadFailList.push(this._downloadingPlugin),console.log("download failed:"+e.state)),this.download()}),this._dialog=getDownloadDialog(),this._dialog.on("dialogbeforeclose",(t,e)=>(this._dlUrl&&o.send("cancel-download-file",this._dlUrl),!0)),this._download_bar=this._dialog.parent().find(".download-progress .download-bar"),this._download_label=this._dialog.parent().find(".download-progress .download-bar .download-label")}startDownload(t,e,s){this._dlUrl=url,this._downloadList=t,this._downloadSuccessList=[],this._downloadFailList=[],this._pluginVersion=e,this._downloadingPlugin=null,this._callback=s,dataMgr.getInstance().fetchManifest((t,e)=>{null!=t?(this.download(),this.show()):this._callback(null,e)})}download(){this._downloadingPlugin=this._downloadList.shift(),this._downloadingPlugin?(this._dlUrl=dataMgr.getInstance().getDownloadPath(this._downloadingPlugin,this._pluginVersion),this._dlUrl?o.send("download-file",this._dlUrl):(this._downloadFailList.push(this._downloadingPlugin),this.download())):0==this._downloadFailList.size()?this._callback(this._downloadSuccessList,null):this._callback(this._downloadSuccessList,"not all plugin download success")}setProgress(t){this._download_bar.css("width",Math.floor(t)+"%"),this._download_label.html(t+"%")}show(){this._dialog.dialog("open"),this._dialog.dialog("moveToTop")}hiden(){this._dialog.dialog("close")}}},55:function(t,e,s){const o=s(18),i=s(11),n=s(2),l=s(6),{ipcRenderer:a}=s(7);s(7).remote.dialog;s(52);const r=s(29),c=s(28),d=s(30);let h;t.exports=class t{static getInstance(){return h||(h=new t),h}constructor(t){this.options=t,"installer"in this.options&&(this.options.installer=!1),this.sdkbox_path=d.getSdkboxBinPath(),this._enableClose=!1,this._dialog||(this._dialog=getInstallSdkboxPluginsDialog(),this._dialog.on("dialogbeforeclose",(t,e)=>this._enableClose),this._downloads=this._dialog.find(".download-plugin-list"),this._downloadItemTemplate=this._downloads.find(".download-plugin-item.hidden"),this._documents=this._dialog.find(".plugin-document-list"),this._documentItemTemplate=this._documents.find(".plugin-document-item.hidden"),this._cliOutput=this._dialog.find(".import-cli-output"),this._buttonCancel=this._dialog.parent().find(".ui-dialog-buttonset button"),this._downloadItemTemplate.detach(),this._documentItemTemplate.detach(),this.registerDownloadEvent()),this.clear(),c.getInstance().fetchManifest((t,e)=>{e||(this.resetDownloadItems(this.options.plugins,this.options.installer),this.resetDialog(),this.enableClose(),this._buttonCancel.addClass("ui-state-active"),this.tryInstall(),this.downloadNext())})}show(){this._dialog.dialog("open"),this._dialog.dialog("moveToTop")}close(){this._dialog.dialog("close")}enableClose(){this._enableClose=!0,this._buttonCancel.button("enable")}disableClose(){this._enableClose=!1,this._buttonCancel.button("disable")}clear(){this._buttonCancel.text("Cancel"),this._downloads.empty(),this._downloads.append(this._downloadItemTemplate),this._documents.empty(),this._documents.append(this._documentItemTemplate),this._cliOutput.empty()}appendDependency(t){let e=c.getInstance().getDependency(t);return e=e.concat(t),e=o.arrayUnique(e)}resetDownloadItems(t,e){const s=this.appendDependency(t);let o=[];e&&o.push({name:"Installer",bundle:c.getInstance().getInstallerPath(),status:"pending"});for(let t in s){const e=s[t],i=c.getInstance().getDownloadPath(e,"v3");null!=i&&o.push({name:e,display_name:c.getInstance().getDisplayName(e),bundle:i,status:this.checkPluginValid(i)})}this._installItems=o}checkPluginValid(t){let e=t.bundle.split("/").pop(),s=n.join(i.homedir(),".sdkbox","plugins",e);if(l.existsSync(s))return"ready";{s=s.slice(0,-7);let t=null;try{t=l.statSync(s)}catch(e){t=null}return t&&t.isDirectory()?"ready":"pending"}}resetDialog(){for(let t in this._installItems){const e=this._installItems[t];let s=this._downloadItemTemplate.clone();if(s.removeClass("hidden"),s.find(".download-plugin-name").html(e.display_name),s.find(".download-plugin-status").html(e.status),"ready"==e.status&&(s.find(".download-plugin-bar").css("width","100%"),s.find(".download-plugin-label").html("100%")),this._downloads.append(s),"installer"===e.name.toLowerCase())continue;if("googleplayservices"===e.name)continue;let o=this._documentItemTemplate.clone();o.removeClass("hidden"),o.find(".plugin-document-item-name").html(e.display_name);const i=e.name.toLowerCase();o.find(".plugin-document-item-docs").attr("href","http://docs.sdkbox.com/en/plugins/"+i),o.find(".plugin-document-item-sample").attr("href","https://github.com/sdkbox/sdkbox-sample-"+i),this._documents.append(o)}}changeItemStatus(t,e,s){for(var o=this._downloads.children().length-1;o>=0;o--){let i=this._downloads.children().eq(o);const n=i.find(".download-plugin-name").text();if(this.compareCaseInsensitive(t,n)){e&&(e<1&&(e=1),i.find(".download-plugin-bar").css("width",Math.floor(e)+"%"),i.find(".download-plugin-label").html(Math.floor(e)+"%")),s&&i.find(".download-plugin-status").html(s);break}}}compareCaseInsensitive(t,e){return t.toLowerCase()===e.toLowerCase()}showlog(t){this._cliOutput.append($("<div>").html(t))}registerDownloadEvent(){a.on("download-status",(t,e)=>{"interrupted"===e.state?(this.setDownloadItemStatus(e.url,null,"download failed"),this.downloadNext()):"progressing"===e.state&&this.setDownloadItemStatus(e.url,e.downloadRatio,"downloading")}),a.on("download-finish",(t,e)=>{delete this._dlUrl,"completed"===e.state?(this.setDownloadItemStatus(e.url,100,"downloading"),this.moveDownloadFile(e.url)):(this.setDownloadItemStatus(e.url,null,"download failed"),console.log("download failed:"+e.state),this.tryInstall()),this.downloadNext()})}downloadNext(){const t=this.findFirstItem("pending");t?t!=this._downloadingItem&&(this._downloadingItem=t,this.showlog(`Begin download ${t.bundle.bundle}`),a.send("download-file",t.bundle.bundle)):this.disableClose()}findFirstItem(t){for(let e in this._installItems){const s=this._installItems[e];if(t==s.status)return s}}setDownloadItemStatus(t,e,s){for(let o in this._installItems){const i=this._installItems[o];if(this.compareCaseInsensitive(t,i.bundle.bundle)||this.compareCaseInsensitive(t,i.name)){s&&(i.status=s),this.changeItemStatus(i.display_name,e,s);break}}}moveDownloadFile(t){let e=t.split("/").pop(),s=n.join(i.homedir(),".sdkbox","temp",e),o=n.join(i.homedir(),".sdkbox","plugins",e);try{l.rename(s,o,()=>{this.setDownloadItemStatus(t,null,"ready"),this.tryInstall()})}catch(e){this.setDownloadItemStatus(t,null,"download failed"),this.tryInstall()}}tryInstall(){let t=this.findFirstItem("pending");t||(t=this.findFirstItem("downloading"))||this.installNext()}installNext(){const t=this.findFirstItem("ready");if(!t)return this._buttonCancel.text("Finish"),this.enableClose(),c.getInstance().getInstalledPlugins(this.options.project,null,!0),void this.showlog("Install Finish");this.showlog(`Begin install ${t.name}`),this.installPlugin(t.name)}installPlugin(t,e="import"){if(null==this.options.project)return void this.showlog("Error! Project path is null");if(!this.sdkbox_path)return void this.showlog("Error! Can not find SDKBox installer");let s=r.getInstance(),o="sdkbox import "+this.options.project;if(s.query(o))return;this.setDownloadItemStatus(t,null,"installing");let i=[this.sdkbox_path,"--alwaysupdate","--nohelp","--runin","gui-creator","-s","main",e,t];t in this.options.installedPlugins&&(i.push("--forcecopy"),i.push("--nopatching")),c.getInstance().isStaging()&&i.push("--staging"),"tapcore"==t&&(i.push("--apitoken"),i.push(this.options.tapcore_token));const n=c.getInstance().getProjectByPath(this.options.project);if(n){if(!n.isXcodeProjectEnable()&&!n.isAndroidProjectEnable())return;let t=n.getSelectXcodeProject();n.isXcodeProjectEnable()&&t&&(i.push("--projectpath"),i.push(t)),t=n.getSelectAndroidProject(),n.isAndroidProjectEnable()&&t&&(i.push("--projectpath"),i.push(t))}let l={tag:o,cwd:this.options.project};this.showlog("> "+i.join(" ")),s.exec(i,l,{stdout:t=>{this.showlog(t.toString())},stderr:t=>{this.showlog(t.toString())},exit:(s,o)=>{this.setDownloadItemStatus(t,null,"success"),this.showlog(""),this.showlog("-----------------------------------"),this.showlog(""),this.installNext(),"import"==e&&this.installDTS(t)},error:(e,s,o)=>{this.setDownloadItemStatus(t,null,"install failed"),this.showlog(e.toString()),this.installNext()}})}installDTS(t){const e=c.getInstance().getPluginPath(t),s=n.join(e,"plugin","jsbindings");if(!o.isDir(s))return;const i=l.readdirSync(s).filter(t=>t.endsWith(".d.ts")),a=this.options.creator_project_root;for(var r=i.length-1;r>=0;r--)o.copy(n.join(s,i[r]),n.join(a,"sdkbox","js","assist"))}}},59:function(t,e){const s=$("#contents"),o=$("#tabbar li");function i(t){s.find("div.tab-contents").addClass("hidden"),s.find("div#tab-"+t).removeClass("hidden"),s.find("div#tab-"+t).focus(),o.removeClass("selected"),$("#tabbar li[tag="+t+"]").addClass("selected")}o.each((t,e)=>{$(e).on("click",t=>{let e=$(t.target);e.hasClass("selected")||i(e.attr("tag"))})}),e.select_tab=i},6:function(t,e){t.exports=require("fs")},60:function(t,e,s){const o=s(6),i=s(11),n=s(7),l=s(7).ipcRenderer,{BrowserWindow:a,dialog:r}=s(7).remote,c=s(2),d=s(30),h=s(29),u=s(108),p=(s(109),s(110)),g=s(111),f=(s(37),s(54),s(55)),m=s(28),_=s(113),b=s(18),j=s(18).queryParams();t.exports=class{constructor(){this.sdkbox_path=d.getSdkboxBinPath(),this._configs={},this._addCurProjectIf(),this._listHtml=$("#tab-cocos .projects-list ul"),this._projectHtmlTpl=this._listHtml.find("li.template");let t=$("#tab-cocos .projects-details");this._detailsPlaceholderHtml=t.find(".placeholder"),this._detailsPlaceholderHtml.show(),this._detailsWrapperHtml=t.find(".details"),this._detailsWrapperHtml.hide(),this._detailsHtml={},this._detailsHtml.name={icon:t.find(".name .icon img"),title:t.find(".name h2")};let e=t.find(".basics");this._detailsHtml.basics={location:e.find(".location span"),xcodeProjectPath:e.find(".xcode-project-path select"),androidProjectPath:e.find(".android-project-path select"),xcodeProjectCheckBox:e.find(".xcode-project-path input"),androidProjectCheckBox:e.find(".android-project-path input"),engine:e.find(".engine span"),buildHint:t.find(".build-hint")},this._detailsHtml.basics.xcodeProjectPath.change(t=>{this.curPoject.setSelectXcodeProject($(t.target).children("option:selected").val())}),this._detailsHtml.basics.androidProjectPath.change(t=>{this.curPoject.setSelectAndroidProject($(t.target).children("option:selected").val())}),this._detailsHtml.basics.xcodeProjectCheckBox.change(t=>{const e=this._detailsHtml.basics.xcodeProjectCheckBox.is(":checked");this.curPoject.setXcodeProjectEnable(e)}),this._detailsHtml.basics.androidProjectCheckBox.change(t=>{const e=this._detailsHtml.basics.androidProjectCheckBox.is(":checked");this.curPoject.setAndroidProjectEnable(e)}),this._detailsHtml.live={blocks:t.find(".live"),tbody:t.find(".live.block tbody")},this._detailsHtml.plugins={tbody:t.find(".plugins.block tbody")},$("button.import").on("click",()=>{this._onImportClick()}),$(".forStandalone").hide(),t.find("button.build-project").on("click",()=>{this._onBuildProjectClick()}),this._buttons={import:t.find("button.import-plugin"),update:t.find("button.update-all-plugins"),open:t.find("button.open-project-folder"),build:t.find("button.build-project")},t.find("button.open-project-folder").on("click",()=>{this._onOpenProjectFolderClick()}),t.find("button.remove-project").on("click",()=>{this._onRemoveProjectClick()}),t.find("button.import-plugin").on("click",()=>{this.curPoject.isAndroidProjectEnable()||this.curPoject.isXcodeProjectEnable()?this._onImportPluginClick():alert("Anroid and Xcode project both is disable")}),t.find("button.update-all-plugins").on("click",()=>{this.curPoject.isAndroidProjectEnable()||this.curPoject.isXcodeProjectEnable()?this._onUpdateAllPluginsClick():alert("Anroid and Xcode project both is disable")});const s=$("#tab-cocos .tab-cocos-staging-flag");s.change((function(){s.is(":checked")?m.getInstance().changeServer("staging"):m.getInstance().changeServer("production")})),this._projects=new u(p),m.getInstance().projs=this._projects,this._loaders=new Map,this._importPluginsDialog=new g,this._importPluginsDialog.load(),m.getInstance().observeInstalledPlugin((t,e)=>{this.observerInstalledPlugin(t,e)}),Array.isArray(this._configs.cocosProjects)&&this._configs.cocosProjects.forEach(t=>{this._addProject(t,!0)}),l.on("SDKBox:build-finish",()=>{this._configs.cocosProjects=[],this._addCurProjectIf(),this._listHtml.empty(),this._projects.clear(),Array.isArray(this._configs.cocosProjects)&&this._configs.cocosProjects.forEach(t=>{this._addProject(t,!0)}),this._detailsPlaceholderHtml.show(),this._detailsWrapperHtml.hide(),this._showFirstProjectDetail()}),d.installIf(),this._showFirstProjectDetail()}_showBuildHint(t){t?this._detailsHtml.basics.buildHint.show():this._detailsHtml.basics.buildHint.hide()}_addCurProjectIf(){let t=this._findProjects(j.project);for(let e in t)this._addProjectIf(t[e]);if(null==this._configs.cocosProjects||0==this._configs.cocosProjects.length){const t=c.basename(j.project);this._addProjectIf({projectName:t,projectPath:j.project})}}_addProjectIf(t){this._configs.cocosProjects=this._configs.cocosProjects||[];const e=this._configs.cocosProjects.indexOf(t);0!=e&&(e>0&&this._configs.cocosProjects.removeAt(e),this._configs.cocosProjects.unshift(t))}_findProjects(t){const e=c.basename(t);let s=[],n=c.join(t,"local","builder.json"),l="./build";o.existsSync(n)&&(l=JSON.parse(o.readFileSync(n,"utf8")).buildPath),"win32"==i.platform()?l.length>2&&":"==l[1]||(l=c.join(t,l)):l.startsWith("/")||(l=c.join(t,l));const a=l;let r=c.join(a,"jsb-default");return b.isDir(r)&&s.push({projectName:e,projectPath:r}),r=c.join(a,"jsb-link"),b.isDir(r)&&s.push({projectName:e,projectPath:r}),r=c.join(a,"jsb-binary"),b.isDir(r)&&s.push({projectName:e,projectPath:r}),s}_onImportClick(){l.send("open-file-dialog"),l.once("selected-directory",(t,e)=>{if(e)try{e=e[0],this._addProject(e)}catch(t){r.showErrorBox("Import Project Failed",t.toString())}})}_onBuildProjectClick(){l.send("builder:open")}_onOpenProjectFolderClick(){let t=this._detailsHtml.basics.location.text(),e=this._projects.get(t);n.shell.showItemInFolder(e.path),n.shell.beep()}_onRemoveProjectClick(){r.showMessageBox({type:"question",buttons:["No","Yes"],defaultId:0,title:"Are you sure remove selected project ?",message:"Are you sure remove selected project ?",detail:"Project folder and files will not be deleted.",cancelId:0},t=>{if(1==t){let t=this._detailsHtml.basics.location.text(),s=h.getInstance();s.kill("sdkbox info "+t),s.kill("sdkbox list "+t),s.kill("sdkbox import "+t),this._listHtml.find("> li").each((e,s)=>{$(s).attr("path")===t&&$(s).remove()}),this._projects.remove(t),this._detailsPlaceholderHtml.show(),this._detailsWrapperHtml.hide();var e=this._configs.cocosProjects.indexOf(t);e>-1?(this._configs.cocosProjects.splice(e,1),_.getInstance().save(this._configs)):console.log(`remove project, can't find ${t}`)}})}_onImportPluginClick(){let t=this._detailsHtml.basics.location.text(),e=this._projects.get(t);this._importPluginsDialog.open(e,()=>{this._queryProjectSdkboxInfo(e,!0)})}_onUpdateAllPluginsClick(){let t=this._detailsHtml.basics.location.text(),e=this._projects.get(t);if(0==e.plugins.length){let t={type:"question",buttons:["OK"],defaultId:0,title:"Warning",message:"No SDKBox plugin installed! Needn't update.",cancelId:1};r.showMessageBox(a.getFocusedWindow(),t,t=>{})}else{let t={type:"question",buttons:["Update","Cancel"],defaultId:0,title:"Confirm update all installed plugins",message:"Confirm update all installed plugins:",detail:e.path,cancelId:1};r.showMessageBox(a.getFocusedWindow(),t,t=>{0===t&&this._updateAllPlugins(e)})}}_showLoader(t){if(this._loaders.has(t.path))return!1;let e=this._queryItem(t);return e&&e.find(".loader").show(),this._loaders.set(t.path,!0),!0}_hideLoader(t){if(!this._loaders.has(t.path))return!1;let e=this._queryItem(t);return e&&e.find(".loader").hide(),this._loaders.delete(t.path),!0}_showFirstProjectDetail(){let t=this._projects.first();this.curPoject=t,this._showProjectDetail(t,this._queryItem(t))}_showProjectDetail(t,e){t&&e&&(this._listHtml.find("> li").removeClass("selected"),e.addClass("selected"),this._updateDetails(t,!0),this._detailsPlaceholderHtml.hide(),this._detailsWrapperHtml.show(),this._queryProjectSdkboxInfo(t))}_addProject(t,e){let s=null;try{s=this._projects.add(t)}catch(t){return}let o=this._projectHtmlTpl.clone();if(o.attr("path",s.path),o.find(".loader").hide(),o.removeClass("template"),o.on("click",()=>{this.curPoject=s,this._showProjectDetail(s,o)}),this._listHtml.append(o),this._updateItem(s),this._queryProjectSdkboxInfo(s),!e){Array.isArray(this._configs.cocosProjects)||(this._configs.cocosProjects=[]);let e=this._configs.cocosProjects;e.push(t);let s=e.length,o=new Map;for(let t=s-1;t>=0;t--)o.has(e[t])?e.splice(t,1):o.set(e[t],!0);_.getInstance().save(this._configs)}}_queryItem(t){if(!t)return null;let e=this._listHtml.find("> li");for(let s=0;s<e.length;s++){let o=$(e[s]);if(o.attr("path")==t.path)return o}return null}_updateItem(t){let e=this._queryItem(t);if(!e)return;e.find(".icon img").attr("src","../assets/img/cocos-project-icon.png"),e.find(".name h2").text(t.name),t.live&&e.find(".tags").append("<span>Live</span>");let s=e.find(".plugins-tags");s.empty(),$.each(t.plugins,(t,e)=>{s.append("<span>"+e.name+"</span>")})}_updateDetails(t,e){let s=this._detailsHtml;if(!e&&s.basics.location.text()!==t.path)return;s.name.icon.attr("src","../assets/img/cocos-project-icon.png"),s.name.title.text(t.name),s.basics.location.text(t.path),s.basics.xcodeProjectPath.empty(),t.getXcodeProjects().forEach(t=>{s.basics.xcodeProjectPath.append(`<option value ="${c.basename(t)}">${t}</option>`)}),s.basics.xcodeProjectPath.children(`option:eq(${t.getSelectXcodeProject()})`).prop("selected",!0),s.basics.androidProjectPath.empty(),t.getAndroidProjects().forEach(t=>{s.basics.androidProjectPath.append(`<option value ="${c.basename(t)}">${t}</option>`)}),s.basics.androidProjectPath.children(`option:eq(${t.getSelectAndroidProject()})`).prop("selected",!0),s.basics.engine.text(t.engine),t instanceof p&&null==t.template?(s.basics.buildHint.show(),this._buttons.import.attr("disabled",!0).addClass("ui-state-disabled"),this._buttons.update.attr("disabled",!0).addClass("ui-state-disabled")):(s.basics.buildHint.hide(),this._buttons.import.attr("disabled",!1).removeClass("ui-state-disabled"),this._buttons.update.attr("disabled",!1).removeClass("ui-state-disabled")),t.live?s.live.blocks.show():s.live.blocks.hide();let o=s.plugins.tbody;o.empty(),Array.isArray(t.plugins)&&$(t.plugins).each((t,e)=>{let s=m.getInstance().getDisplayName(e.name.toString());s=s||e.name.toString();let i="</td><td>-</td></tr>";if("googleplayservices"!=e.name.toString()){let t=e.name.toString();"gpg"==t&&(t="googleplay"),i=`</td><td><a href="http://docs.sdkbox.com/en/plugins/${t}">Doc</a></td></tr>`}o.append("<tr><td>"+s+"</td><td>"+e.version.toString()+i)})}_queryProjectSdkboxInfo(t,e){this._showLoader(t),m.getInstance().getInstalledPlugins(t.path,(e,s)=>{s?r.showErrorBox("Query SDKBOX Info Failed",s):t.updatePluginsFromJSON(e),this._hideLoader(t),this._updateItem(t),this._updateDetails(t),t._lastQuery=Date.now()})}observerInstalledPlugin(t,e){if(!this._projects)return;const s=this._projects.get(e);if(!s)return;if(Date.now()-s._lastQuery<5e3)return;if(!t)return;this._detailsHtml.basics.location.text()===e&&(this._queryProjectSdkboxInfo(s),s._lastQuery=Date.now())}_updateAllPlugins(t){let e=[];Array.isArray(t.plugins)&&$(t.plugins).each((t,s)=>{e.push(s.name.toString())}),new f({creator_project_root:j.project,plugins:e,project:t.path,cmd:"update",installedPlugins:e}).show()}}},7:function(t,e){t.exports=require("electron")}})}));